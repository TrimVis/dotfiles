#!/usr/bin/env bash

#
# Simple notify script, which allows notification replacement
#

CAT=default
ICO=
SEC=1500
TITLE=""
BODY=""

# read arguments
while getopts c:s:t:b:hi: option
do
    case "${option}"
        in
        i) ICO=${OPTARG};;
        c) CAT=${OPTARG};;
        s) SEC=${OPTARG};;
        t) TITLE=${OPTARG};;
        b) BODY=${OPTARG};;
        h) echo "Simple notify script, which allows notification replacement using dunstify

Usage:
-c Category name, has to be the same for notifications which can replace each other
-s Time in ms notification will be displayed
-t Title of notification
-b Body of notification
-i Icon of notification
-h Shows this help page

Everything except the category is optional"
    esac
done

FILE=$HOME/.config/notify/${CAT}_id

# create file if not already there
[ -f "$FILE" ] || (echo "0" > "$FILE")

#read notification id
ID=$(cat "$FILE")

if [ -z "$ICO" ]
then
	ID=$(dunstify -t $SEC -p -r $ID "$TITLE" "$BODY")
else
	ID=$(dunstify -t $1 -i $4 -p -r $ID "$TITLE" "$BODY")
fi

if [ -z "$ID" ]
then
	echo "0" > "$FILE"
else
	echo "$ID" > "$FILE"
fi
